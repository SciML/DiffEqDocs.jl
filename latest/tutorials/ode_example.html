<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Ordinary Differential Equations (ODE) · DifferentialEquations.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.5.0/styles/default.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Ubuntu+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="../assets/documenter.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../assets/documenter.js"></script></head><body><nav class="toc"><h1>DifferentialEquations.jl</h1><form class="search" action="../search.html"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../index.html">Home</a></li><li><span class="toctext">Tutorials</span><ul><li class="current"><a class="toctext" href="ode_example.html">Ordinary Differential Equations (ODE)</a><ul class="internal"></ul></li><li><a class="toctext" href="sde_example.html">Stochastic Differential Equations (SDE)</a></li><li><a class="toctext" href="dae_example.html">Differential Algebraic Equations (DAE)</a></li><li><a class="toctext" href="fempoisson_example.html">Poisson Equation Finite Element Method</a></li><li><a class="toctext" href="femheat_example.html">Heat Equation Finite Element Method</a></li><li><a class="toctext" href="femstochastic_example.html">Stochastic Finite Element Method</a></li></ul></li><li><span class="toctext">Solver Options</span><ul><li><a class="toctext" href="../solvers/ode_solve.html">Ordinary Differential Equation Solvers</a></li><li><a class="toctext" href="../solvers/sde_solve.html">Stochastic Differential Equation Solvers</a></li><li><a class="toctext" href="../solvers/dae_solve.html">Differential Algebraic Equation Solvers</a></li><li><a class="toctext" href="../solvers/fempoisson_solve.html">Finite Element Method Poisson Equation Solvers</a></li><li><a class="toctext" href="../solvers/femheat_solve.html">Finite Element Method Heat Equation Solvers</a></li><li><a class="toctext" href="../solvers/fdmstokes_solve.html">Finite Difference Method Stokes Equation Solvers</a></li></ul></li><li><span class="toctext">Manual</span><ul><li><a class="toctext" href="../man/overview.html">Overview of DifferentialEquations.jl</a></li><li><a class="toctext" href="../man/ODEProblem.html">Defining an ODE Problem</a></li><li><a class="toctext" href="../man/SDEProblem.html">Defining a SDE Problem</a></li><li><a class="toctext" href="../man/FEMProblem.html">Defining a FEM Problem</a></li><li><a class="toctext" href="../man/StokesProblem.html">Defining a Stokes Problem</a></li><li><a class="toctext" href="../man/mesh.html">Meshes</a></li><li><a class="toctext" href="../man/solution.html">The Solution Type</a></li><li><a class="toctext" href="../man/output_specification.html">Output Specification</a></li><li><a class="toctext" href="../man/callback_functions.html">Event Handling and Callback Functions</a></li><li><a class="toctext" href="../man/plot.html">Plot Functions</a></li><li><a class="toctext" href="../man/parameter_estimation.html">Parameter Estimation</a></li><li><a class="toctext" href="../man/sensitivity.html">Sensitivity Analysis</a></li><li><a class="toctext" href="../man/function_definition_macros.html">Function Definition Macros</a></li><li><a class="toctext" href="../man/benchmarks.html">Benchmark Suite</a></li><li><a class="toctext" href="../man/convergence.html">Convergence Simulations</a></li><li><a class="toctext" href="../man/conditional_dependencies.html">Conditional Dependencies</a></li><li><a class="toctext" href="../man/progress_bar.html">Juno Progress Bar Integration</a></li></ul></li><li><span class="toctext">Internal Documentation</span><ul><li><a class="toctext" href="../internals/contributors_guide.html">Contributor&#39;s Guide</a></li><li><a class="toctext" href="../internals/fem_tools.html">Internal Finite Element Tools</a></li><li><a class="toctext" href="../internals/extras.html">Extra Functions</a></li><li><a class="toctext" href="../internals/solver_helpers.html">Solver Helpers</a></li><li><a class="toctext" href="../internals/notes_on_algorithms.html">Notes on Algorithms</a></li><li><a class="toctext" href="../internals/function_index.html">Function Index</a></li></ul></li></ul></nav><article id="docs"><header><nav><ul><li>Tutorials</li><li><a href="ode_example.html">Ordinary Differential Equations (ODE)</a></li></ul><a class="edit-page" href="https://github.com/JuliaDiffEq/DiffEqDocs.jl/tree/f10effccbb546e67aed298ef1006ce2d893fbd28/docs/src/tutorials/ode_example.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/></header><h1><a class="nav-anchor" id="Ordinary-Differential-Equations-(ODE)-1" href="#Ordinary-Differential-Equations-(ODE)-1">Ordinary Differential Equations (ODE)</a></h1><p>This tutorial will introduce you to the functionality for solving ODEs. Other introductions can be found by <a href="https://github.com/JuliaDiffEq/DifferentialEquations.jl/tree/master/examples">checking out the IJulia notebooks in the examples folder</a>.</p><p>In this example we will solve the equation</p><div>\[\frac{du}{dt} = f(t,u)\]</div><p>where <span>$f(t,u)=αu$</span>. We know via Calculus that the solution to this equation is <span>$u(t)=u₀\exp(αt)$</span>. To solve this numerically, we define a problem type by giving it the equation and the initial condition:</p><pre><code class="language-julia">using DifferentialEquations
α=1
u₀=1/2
f(t,u) = u
prob = ODEProblem(f,u₀)</code></pre><p>Then we setup some parameters:</p><pre><code class="language-julia">Δt = 1/2^(4) #The initial step size. It will automatically determined if not given.
tspan = [0,1] # The timespan. This is the default if not given.</code></pre><p>We then send these items to the solver.</p><pre><code class="language-julia">sol =solve(prob::ODEProblem,tspan,Δt=Δt,alg=:Euler)</code></pre><p>To see what&#39;s in the solution object, we can print it:</p><pre><code class="language-julia">print(sol)
#DifferentialEquations.ODESolution with 17 timesteps. No analytical solution is known.
#u: 1.3189642486832998
#t: [0.0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1.0]
#timeseries: [0.5,0.53125,0.564453,0.599731,0.637215,0.677041,0.719356,0.764315,0.812085,0.86284,0.916768,0.974066,1.03494,1.09963,1.16836,1.24138,1.31896]</code></pre><p>We can access the 5th value of the solution with</p><pre><code class="language-julia">sol[5]
#.637</code></pre><p>or get the time of the 8th timestep by</p><pre><code class="language-julia">sol.t[8]
#.438</code></pre><p>The object that is returns by default acts as a continuous solution via an interpolation. We can access the interpolated values by treating <code>sol</code> as a function, for example:</p><pre><code class="language-julia">sol(0.45) # The value of the solution at t=0.45</code></pre><p>For details on more finely controlling the output, see <a href="http://juliadiffeq.github.io/DifferentialEquations.jl/latest/man/output_specification.html">the output specification manual page</a></p><p>Plotting commands are provided via a recipe to Plots.jl. To plot the solution object, simply call plot:</p><pre><code class="language-julia">plot(sol)</code></pre><p>If you are in Juno, this will plot to the plot pane. To open an interactive GUI (dependent on the backend), use the <code>gui</code> command:</p><pre><code class="language-julia">Plots.gui() # Opens a GUI</code></pre><p>The plot function can be formatted using <a href="https://juliaplots.github.io/">the attributes available in Plots.jl</a>. For more of an introduction to plotting solutions, <a href="https://github.com/JuliaDiffEq/DifferentialEquations.jl/blob/master/examples/Formatting%20the%20Plots.ipynb">see the IJulia notebook</a>.</p><h3><a class="nav-anchor" id="Other-Algorithms-1" href="#Other-Algorithms-1">Other Algorithms</a></h3><p>In that first example, we used <code>alg=:Euler</code> to set the solver to a 1st order Euler method. We can instead solve using the default method, the Dormand-Prince 4/5 method, (the same as MATLAB&#39;s <code>ode45</code>) by not specifying the algorithm:</p><pre><code class="language-julia">sol =solve(prob::ODEProblem,tspan)</code></pre><p>By default adaptive timestepping will be on, and the initial timestep will be heuristically chosen if not given. We can choose a higher order algorithm like the 7th order Verner Efficient method, turn off adaptive timestepping, and set the initial timestep to the previously set value via:</p><pre><code class="language-julia">sol =solve(prob::ODEProblem,tspan,Δt=Δt,alg=:Vern7,adaptive=false)
plot(sol)</code></pre><p><img src="../assets/introODEplot.png" alt="Better ODE Solution"/></p><p>Please see the solver documentation for more algorithms and keyword arguments.</p><h3><a class="nav-anchor" id="Systems-of-Equations-1" href="#Systems-of-Equations-1">Systems of Equations</a></h3><p>We can also solve systems of equations. DifferentialEquations.jl can handle any size problem, so instead of showing it for a vector, let&#39;s let u be a matrix! To do this, we simply need to have u₀ be a matrix, and define f such that it takes in a matrix and outputs a matrix. We can define a matrix of linear ODEs as follows:</p><pre><code class="language-julia">A = [1. 0 0 -5
     4 -2 4 -3
     -4 0 0 1
     5 -2 2 3]
u0 = rand(4,2)
f(t,u) = A*u
prob = ODEProblem(f,u0)</code></pre><p>Here our ODE is on a 4x2 matrix, and the ODE is the linear system defined by multiplication by <code>A</code>. To solve the ODE, we do the same steps as before.</p><pre><code class="language-julia">sol = solve(prob,tspan)
plot(sol)</code></pre><p><img src="../assets/multiODEplot.png" alt="ODE System Solution"/></p><h3><a class="nav-anchor" id="Defining-Systems-of-Equations-Eloquently-Using-@ode_define-1" href="#Defining-Systems-of-Equations-Eloquently-Using-@ode_define-1">Defining Systems of Equations Eloquently Using @ode_define</a></h3><p>To simplify your life, DifferentialEquations.jl provides the <code>@ode_define</code> macro for &quot;defining your ODE in pseudocode&quot; and getting a function which is efficient and runnable. For our example we will use <a href="https://en.wikipedia.org/wiki/Lorenz_system">the Lorenz system</a>. The standard way to write this out in most mathematical programs is the following:</p><pre><code class="language-julia">f = (t,u,du) -&gt; begin
 du[1] = 10.0(u[2]-u[1])
 du[2] = u[1]*(28.0-u[3]) - u[2]
 du[3] = u[1]*u[2] - (8/3)*u[3]
end</code></pre><p>Here for more efficiency we plugged in the parameters. However, this does not look like the pretty <span>$\LaTeX$</span> system we see on Wikipedia, and this might make it harder to double-check that you defined the system correctly. Using the <code>@ode_define</code> macro is much nicer:</p><pre><code class="language-julia">g = @ode_define begin
  dx = σ*(y-x)
  dy = x*(ρ-z) - y
  dz = x*y - β*z
end σ=&gt;10. ρ=&gt;28. β=&gt;(8/3)</code></pre><p>DifferentialEquations.jl will automatically translate this to be exactly the same as <code>f</code>. The result is more legible code with no performance loss.</p><footer><hr/><a class="previous" href="../index.html"><span class="direction">Previous</span><span class="title">Home</span></a><a class="next" href="sde_example.html"><span class="direction">Next</span><span class="title">Stochastic Differential Equations (SDE)</span></a></footer></article></body></html>
