<!DOCTYPE html>

<html lang="en"><head><meta charset="utf-8"/><meta content="width=device-width, initial-scale=1.0" name="viewport"/><title>Plot Functions · DifferentialEquations.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script data-main="../assets/documenter.js" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link href="../assets/documenter.css" rel="stylesheet" type="text/css"/><link href="https://docs.juliadiffeq.org/stable/basics/plot/index.html" rel="canonical"/></head><body><nav class="toc"><a href="../index.html"><img alt="DifferentialEquations.jl logo" class="logo" src="../assets/logo.png"/></a><h1>DifferentialEquations.jl</h1><select id="version-selector" onchange="window.location.href=this.value" style="visibility: hidden"></select><form action="../search.html" class="search" id="search-form"><input id="search-query" name="q" placeholder="Search docs" type="text"/></form><ul><li><a class="toctext" href="../index.html">Home</a></li><li><span class="toctext">Tutorials</span><ul><li><a class="toctext" href="../tutorials/ode_example.html">Ordinary Differential Equations</a></li><li><a class="toctext" href="../tutorials/sde_example.html">Stochastic Differential Equations</a></li><li><a class="toctext" href="../tutorials/rode_example.html">Random Ordinary Differential Equations</a></li><li><a class="toctext" href="../tutorials/dde_example.html">Delay Differential Equations</a></li><li><a class="toctext" href="../tutorials/dae_example.html">Differential Algebraic Equations</a></li><li><a class="toctext" href="../tutorials/discrete_stochastic_example.html">Discrete Stochastic (Gillespie) Equations</a></li><li><a class="toctext" href="../tutorials/jump_diffusion.html">Jump Diffusion Equations</a></li><li><a class="toctext" href="../tutorials/fempoisson_example.html">Poisson Equation Finite Element Method</a></li><li><a class="toctext" href="../tutorials/femheat_example.html">Heat Equation Finite Element Method</a></li><li><a class="toctext" href="../tutorials/femstochastic_example.html">Stochastic Finite Element Method</a></li><li><a class="toctext" href="../tutorials/bvp_example.html">Boundary Value Problems</a></li></ul></li><li><span class="toctext">Basics</span><ul><li><a class="toctext" href="overview.html">Overview of DifferentialEquations.jl</a></li><li><a class="toctext" href="common_solver_opts.html">Common Solver Options</a></li><li><a class="toctext" href="solution.html">Solution Handling</a></li><li class="current"><a class="toctext" href="plot.html">Plot Functions</a><ul class="internal"><li><a class="toctext" href="#Standard-Plots-Using-the-Plot-Recipe-1">Standard Plots Using the Plot Recipe</a></li><li><a class="toctext" href="#Density-1">Density</a></li><li><a class="toctext" href="#Choosing-Variables-1">Choosing Variables</a></li><li><a class="toctext" href="#Animations-1">Animations</a></li><li><a class="toctext" href="#Plotting-Without-the-Plot-Recipe-1">Plotting Without the Plot Recipe</a></li></ul></li><li><a class="toctext" href="integrator.html">Integrator Interface</a></li><li><a class="toctext" href="compatibility_chart.html">Solver Compatibility Chart</a></li></ul></li><li><span class="toctext">Problem Types</span><ul><li><a class="toctext" href="../types/discrete_types.html">Discrete Problems</a></li><li><a class="toctext" href="../types/ode_types.html">ODE Problems</a></li><li><a class="toctext" href="../types/dynamical_types.html">Dynamical, Hamiltonian and 2nd Order ODE Problems</a></li><li><a class="toctext" href="../types/split_ode_types.html">Split ODE Problems</a></li><li><a class="toctext" href="../types/steady_state_types.html">Steady State Problems</a></li><li><a class="toctext" href="../types/bvp_types.html">BVP Problems</a></li><li><a class="toctext" href="../types/sde_types.html">SDE Problems</a></li><li><a class="toctext" href="../types/rode_types.html">RODE Problems</a></li><li><a class="toctext" href="../types/dde_types.html">DDE Problems</a></li><li><a class="toctext" href="../types/dae_types.html">DAE Problems</a></li><li><a class="toctext" href="../types/jump_types.html">Jump Problems</a></li><li><a class="toctext" href="../types/fem_types.html">FEM Problems</a></li></ul></li><li><span class="toctext">Solver Algorithms</span><ul><li><a class="toctext" href="../solvers/discrete_solve.html">Discrete Solvers</a></li><li><a class="toctext" href="../solvers/ode_solve.html">ODE Solvers</a></li><li><a class="toctext" href="../solvers/dynamical_solve.html">Dynamical, Hamiltonian, and 2nd Order ODE Solvers</a></li><li><a class="toctext" href="../solvers/split_ode_solve.html">Split ODE Solvers</a></li><li><a class="toctext" href="../solvers/steady_state_solve.html">Steady State Solvers</a></li><li><a class="toctext" href="../solvers/bvp_solve.html">BVP Solvers</a></li><li><a class="toctext" href="../solvers/sde_solve.html">SDE Solvers</a></li><li><a class="toctext" href="../solvers/rode_solve.html">RODE Solvers</a></li><li><a class="toctext" href="../solvers/dde_solve.html">DDE Solvers</a></li><li><a class="toctext" href="../solvers/dae_solve.html">DAE Solvers</a></li><li><a class="toctext" href="../solvers/fempoisson_solve.html">FEM Poisson Solvers</a></li><li><a class="toctext" href="../solvers/femheat_solve.html">FEM Heat Solvers</a></li></ul></li><li><span class="toctext">Additional Features</span><ul><li><a class="toctext" href="../features/performance_overloads.html">Performance Overloads</a></li><li><a class="toctext" href="../features/diffeq_arrays.html">DiffEq-Specific Array Types</a></li><li><a class="toctext" href="../features/diffeq_operator.html">DiffEqOperators</a></li><li><a class="toctext" href="../features/noise_process.html">Noise Processes</a></li><li><a class="toctext" href="../features/linear_nonlinear.html">Specifying (Non)Linear Solvers</a></li><li><a class="toctext" href="../features/callback_functions.html">Event Handling and Callback Functions</a></li><li><a class="toctext" href="../features/callback_library.html">Callback Library</a></li><li><a class="toctext" href="../features/monte_carlo.html">Parallel Monte Carlo Simulations</a></li><li><a class="toctext" href="../features/io.html">I/O: Saving and Loading Solution Data</a></li><li><a class="toctext" href="../features/low_dep.html">Low Dependency Usage</a></li><li><a class="toctext" href="../features/mesh.html">Meshes</a></li><li><a class="toctext" href="../features/progress_bar.html">Juno Progress Bar Integration</a></li></ul></li><li><span class="toctext">Analysis Tools</span><ul><li><a class="toctext" href="../analysis/parameterized_functions.html">ParameterizedFunctions</a></li><li><a class="toctext" href="../analysis/parameter_estimation.html">Parameter Estimation</a></li><li><a class="toctext" href="../analysis/bifurcation.html">Bifurcation Analysis</a></li><li><a class="toctext" href="../analysis/sensitivity.html">Sensitivity Analysis</a></li><li><a class="toctext" href="../analysis/uncertainty_quantification.html">Uncertainty Quantification</a></li><li><a class="toctext" href="../analysis/dev_and_test.html">Algorithm Development and Testing</a></li></ul></li><li><span class="toctext">Domain Modeling Tools</span><ul><li><a class="toctext" href="../models/multiscale.html">Multi-Scale Models</a></li><li><a class="toctext" href="../models/physical.html">Physical Models</a></li><li><a class="toctext" href="../models/financial.html">Financial Models</a></li><li><a class="toctext" href="../models/biological.html">Chemical Reaction Models</a></li><li><a class="toctext" href="../models/external_modeling.html">External Modeling Packages</a></li></ul></li><li><span class="toctext">Extra Details</span><ul><li><a class="toctext" href="../extras/timestepping.html">Timestepping Method Descriptions</a></li></ul></li></ul></nav><article id="docs"><header><nav><ul><li>Basics</li><li><a href="plot.html">Plot Functions</a></li></ul><a class="edit-page" href="https://github.com/JuliaDiffEq/DiffEqDocs.jl/blob/master/docs/src/basics/plot.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Plot Functions</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" href="#Plot-Functions-1" id="Plot-Functions-1">Plot Functions</a></h1><h2><a class="nav-anchor" href="#Standard-Plots-Using-the-Plot-Recipe-1" id="Standard-Plots-Using-the-Plot-Recipe-1">Standard Plots Using the Plot Recipe</a></h2><p>Plotting functionality is provided by recipes to Plots.jl. To plot solutions, simply call the <code>plot(type)</code> after importing Plots.jl and the plotter will generate appropriate plots.</p><pre><code class="language-julia">#Pkg.add("Plots") # You need to install Plots.jl before your first time using it!
using Plots
plot(sol) # Plots the solution</code></pre><p>Many of the types defined in the DiffEq universe, such as <code>ODESolution</code>, <code>ConvergenceSimulation</code> <code>WorkPrecision</code>, etc. have plot recipes to handle the default plotting behavior. Plots can be customized using <a href="http://docs.juliaplots.org/latest/supported/">all of the keyword arguments provided by Plots.jl</a>. For example, we can change the plotting backend to the GR package and put a title on the plot by doing:</p><pre><code class="language-julia">gr()
plot(sol,title="I Love DiffEqs!")</code></pre><h2><a class="nav-anchor" href="#Density-1" id="Density-1">Density</a></h2><p>If the problem was solved with <code>dense=true</code>, then <code>denseplot</code> controls whether to use the dense function for generating the plot, and <code>plotdensity</code> is the number of evenly-spaced points (in time) to plot. For example:</p><pre><code class="language-julia">plot(sol,denseplot=false)</code></pre><p>means "only plot the points which the solver stepped to", while:</p><pre><code class="language-julia">plot(sol,plotdensity=1000)</code></pre><p>means to plot 1000 points using the dense function (since <code>denseplot=true</code> by default).</p><h2><a class="nav-anchor" href="#Choosing-Variables-1" id="Choosing-Variables-1">Choosing Variables</a></h2><p>In the plot command, one can choose the variables to be plotted in each plot. The master form is:</p><pre><code class="language-julia">vars = [(f1,0,1), (f2,1,3), (f3,4,5)]</code></pre><p>which could be used to plot <code>f1(var₀, var₁)</code>, <code>f2(var₁, var₃)</code>, and <code>f3(var₄, var₅)</code>, all on the same graph. (<code>0</code> is considered to be <em>time</em>, or the independent variable). Functions <code>f1</code>, <code>f2</code> and <code>f3</code> should take in scalars and return a tuple. If no function is given, for example,</p><pre><code class="language-julia">vars = [(0,1), (1,3), (4,5)]</code></pre><p>this would mean "plot <code>var₁(t)</code> vs <code>t</code> (<em>time</em>), <code>var₃(var₁)</code> vs <code>var₁</code>, and <code>var₅(var₄)</code> vs <code>var₄</code> all on the same graph, putting the independent variables (<code>t</code>, <code>var₁</code> and <code>var₄</code>) on the x-axis." While this can be used for everything, the following conveniences are provided:</p><ul><li><p>Everywhere in a tuple position where we only find an integer, this variable is plotted as a function of time.  For example, the list above is equivalent to:</p></li></ul><pre><code class="language-julia">vars = [1, (1,3), (4,5)]</code></pre><p>and</p><pre><code class="language-julia">vars = [1, 3, 4]</code></pre><p>is the most concise way to plot the variables 1, 3, and 4 as a function of time.</p><ul><li><p>It is possible to omit the list if only one plot is wanted: <code>(2,3)</code> and <code>4</code> are respectively equivalent to <code>[(2,3)]</code> and <code>[(0,4)]</code>.</p></li><li><p>A tuple containing one or several lists will be expanded by associating corresponding elements of the lists with each other:</p></li></ul><pre><code class="language-julia">vars = ([1,2,3], [4,5,6])</code></pre><p>is equivalent to</p><pre><code class="language-julia">vars = [(1,4), (2,5), (3,6)]</code></pre><p>and</p><pre><code class="language-julia">vars = (1, [2,3,4])</code></pre><p>is equivalent to</p><pre><code class="language-julia">vars = [(1,2), (1,3), (1,4)]</code></pre><ul><li><p>Instead of using integers, one can use the symbols from a <code>ParameterizedFunction</code>. For example, <code>vars=(:x,:y)</code> will replace the symbols with the integer values for components <code>:x</code> and <code>:y</code>.</p></li><li><p>n-dimensional groupings are allowed. For example, <code>(1,2,3,4,5)</code> would be a 5-dimensional plot between the associated variables.</p></li></ul><h3><a class="nav-anchor" href="#Complex-Numbers-and-High-Dimensional-Plots-1" id="Complex-Numbers-and-High-Dimensional-Plots-1">Complex Numbers and High Dimensional Plots</a></h3><p>The recipe library DimensionalPlotRecipes.jl is provided for extra functionality on high dimensional numbers (complex numbers) and other high dimensional plots. See <a href="https://github.com/JuliaDiffEq/DimensionalPlotRecipes.jl">the README</a> for more details on the extra controls that exist.</p><h3><a class="nav-anchor" href="#Timespan-1" id="Timespan-1">Timespan</a></h3><p>A plotting timespan can be chosen by the <code>tspan</code> argument in <code>plot</code>. For example:</p><pre><code class="language-julia">plot(sol,tspan=(0.0,40.0))</code></pre><p>only plots between <code>t=0.0</code> and <code>t=40.0</code>. If <code>denseplot=true</code> these bounds will be respected exactly. Otherwise the first point inside and last point inside the interval will be plotted, i.e. no points outside the interval will be plotted.</p><h3><a class="nav-anchor" href="#Example-1" id="Example-1">Example</a></h3><pre><code class="language-julia">using DifferentialEquations, Plots
lorenz = @ode_def Lorenz begin
  dx = σ*(y-x)
  dy = ρ*x-y-x*z
  dz = x*y-β*z
end σ = 10.0 β = 8.0/3.0 ρ =&gt; 28.0

u0 = [1., 5., 10.]
tspan = (0., 100.)
prob = ODEProblem(lorenz, u0, tspan)
sol = solve(prob)

xyzt = plot(sol, plotdensity=10000,lw=1.5)
xy = plot(sol, plotdensity=10000, vars=(:x,:y))
xz = plot(sol, plotdensity=10000, vars=(:x,:z))
yz = plot(sol, plotdensity=10000, vars=(:y,:z))
xyz = plot(sol, plotdensity=10000, vars=(:x,:y,:z))
plot(plot(xyzt,xyz),plot(xy, xz, yz, layout=(1,3),w=1), layout=(2,1))</code></pre><p><img alt="lorenz_plot" src="../assets/vars_plotting_example.png"/></p><p>An example using the functions:</p><pre><code class="language-julia">f(x,y,z) = (sqrt(x^2+y^2+z^2),x)
plot(sol,vars=(f,:x,:y,:z))</code></pre><p><img alt="norm_plot" src="../assets/normalized.png"/></p><h2><a class="nav-anchor" href="#Animations-1" id="Animations-1">Animations</a></h2><p>Using the iterator interface over the solutions, animations can also be generated via the <code>animate(sol)</code> command. One can choose the <code>filename</code> to save to via <code>animate(sol,filename)</code>, while the frames per second <code>fps</code> and the density of steps to show <code>every</code> can be specified via keyword arguments. The rest of the arguments will be directly passed to the plot recipe to be handled as normal. For example, we can animate our solution with a larger line-width which saves every 4th frame via:</p><pre><code class="language-julia">#Pkg.add("ImageMagick") # You may need to install ImageMagick.jl before your first time using it!
#using ImageMagick # Some installations require using ImageMagick for good animations
animate(sol,lw=3,every=4)</code></pre><p>Please see <a href="https://juliaplots.github.io/">Plots.jl's documentation</a> for more information on the available attributes.</p><h2><a class="nav-anchor" href="#Plotting-Without-the-Plot-Recipe-1" id="Plotting-Without-the-Plot-Recipe-1">Plotting Without the Plot Recipe</a></h2><p>What if you don't want to use Plots.jl? Odd choice, but that's okay! If the differential equation was described by a vector of values, then the solution object acts as an <code>AbstractMatrix</code> <code>sol[i,j]</code> for the <code>i</code>th variable at timepoint <code>j</code>. You can use this to plot solutions. For example, in PyPlot, Gadfly, GR, etc., you can do the following to plot the timeseries:</p><pre><code class="language-julia">plot(sol.t,sol')</code></pre><p>since these plot along the columns, and <code>sol'</code> has the timeseries along the column. Phase plots can be done similarly, for example:</p><pre><code class="language-julia">plot(sol[i,:],sol[j,:],sol[k,:])</code></pre><p>is a 3d phase plot between variables <code>i</code>, <code>j</code>, and <code>k</code>.</p><p>Notice that this does not use the interpolation. When not using the plot recipe, the interpolation must be done manually. For example:</p><pre><code class="language-julia">dt = 0.001 #spacing in time
ts = linspace(0,1,dt)
plot(sol(ts,idxs=i),sol(ts,idxs=j),sol(ts,idxs=k))</code></pre><p>is the phase space using values <code>0.001</code> apart in time.</p><footer><hr/><a class="previous" href="solution.html"><span class="direction">Previous</span><span class="title">Solution Handling</span></a><a class="next" href="integrator.html"><span class="direction">Next</span><span class="title">Integrator Interface</span></a></footer></article></body></html>
