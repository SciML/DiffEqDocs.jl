<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Plot Functions · DifferentialEquations.jl</title><script async src="https://www.googletagmanager.com/gtag/js?id=UA-90474609-3"></script><script>  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-90474609-3', {'page_path': location.pathname + location.search + location.hash});
</script><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://docs.sciml.ai/DiffEqDocs/stable/basics/plot/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="DifferentialEquations.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">DifferentialEquations.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">DifferentialEquations.jl: Scientific Machine Learning (SciML) Enabled Simulation and Estimation</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../../tutorials/ode_example/">Ordinary Differential Equations</a></li><li><a class="tocitem" href="../../tutorials/faster_ode_example/">Code Optimization for Differential Equations</a></li><li><a class="tocitem" href="../../tutorials/advanced_ode_example/">Solving Large Stiff Equations</a></li><li><a class="tocitem" href="../../tutorials/sde_example/">Stochastic Differential Equations</a></li><li><a class="tocitem" href="../../tutorials/rode_example/">Random Ordinary Differential Equations</a></li><li><a class="tocitem" href="../../tutorials/dde_example/">Delay Differential Equations</a></li><li><a class="tocitem" href="../../tutorials/dae_example/">Differential Algebraic Equations</a></li><li><a class="tocitem" href="../../tutorials/discrete_stochastic_example/">Continuous-Time Jump Processes and Gillespie Methods</a></li><li><a class="tocitem" href="../../tutorials/jump_diffusion/">Jump Diffusion Equations</a></li><li><a class="tocitem" href="../../tutorials/bvp_example/">Boundary Value Problems</a></li><li><a class="tocitem" href="../../tutorials/additional/">Additional Tutorials</a></li></ul></li><li><span class="tocitem">Basics</span><ul><li><a class="tocitem" href="../overview/">Overview of DifferentialEquations.jl</a></li><li><a class="tocitem" href="../common_solver_opts/">Common Solver Options (Solve Keyword Arguments)</a></li><li><a class="tocitem" href="../solution/">Solution Handling</a></li><li class="is-active"><a class="tocitem" href>Plot Functions</a><ul class="internal"><li><a class="tocitem" href="#Standard-Plots-Using-the-Plot-Recipe"><span>Standard Plots Using the Plot Recipe</span></a></li><li><a class="tocitem" href="#Density"><span>Density</span></a></li><li><a class="tocitem" href="#plot_vars"><span>Choosing Variables</span></a></li><li><a class="tocitem" href="#Animations"><span>Animations</span></a></li><li><a class="tocitem" href="#Plotting-Without-the-Plot-Recipe"><span>Plotting Without the Plot Recipe</span></a></li></ul></li><li><a class="tocitem" href="../integrator/">Integrator Interface</a></li><li><a class="tocitem" href="../problem/">Problem Interface</a></li><li><a class="tocitem" href="../faq/">Frequently Asked Questions</a></li><li><a class="tocitem" href="../compatibility_chart/">Solver Compatibility Chart</a></li></ul></li><li><span class="tocitem">Problem Types</span><ul><li><a class="tocitem" href="../../types/discrete_types/">Discrete Problems</a></li><li><a class="tocitem" href="../../types/ode_types/">ODE Problems</a></li><li><a class="tocitem" href="../../types/nonautonomous_linear_ode/">Non-autonomous Linear ODE / Lie Group Problems</a></li><li><a class="tocitem" href="../../types/dynamical_types/">Dynamical, Hamiltonian and 2nd Order ODE Problems</a></li><li><a class="tocitem" href="../../types/split_ode_types/">Split ODE Problems</a></li><li><a class="tocitem" href="../../types/steady_state_types/">Steady State Problems</a></li><li><a class="tocitem" href="../../types/bvp_types/">BVP Problems</a></li><li><a class="tocitem" href="../../types/sde_types/">SDE Problems</a></li><li><a class="tocitem" href="../../types/sdae_types/">SDAE Problems</a></li><li><a class="tocitem" href="../../types/rode_types/">RODE Problems</a></li><li><a class="tocitem" href="../../types/dde_types/">DDE Problems</a></li><li><a class="tocitem" href="../../types/sdde_types/">SDDE Problems</a></li><li><a class="tocitem" href="../../types/dae_types/">DAE Problems</a></li><li><a class="tocitem" href="../../types/jump_types/">Jump Problems</a></li></ul></li><li><span class="tocitem">Solver Algorithms</span><ul><li><a class="tocitem" href="../../solvers/discrete_solve/">Discrete Solvers</a></li><li><a class="tocitem" href="../../solvers/ode_solve/">ODE Solvers</a></li><li><a class="tocitem" href="../../solvers/nonautonomous_linear_ode/">Non-autonomous Linear ODE / Lie Group ODE Solvers</a></li><li><a class="tocitem" href="../../solvers/dynamical_solve/">Dynamical, Hamiltonian, and 2nd Order ODE Solvers</a></li><li><a class="tocitem" href="../../solvers/split_ode_solve/">Split ODE Solvers</a></li><li><a class="tocitem" href="../../solvers/steady_state_solve/">Steady State Solvers</a></li><li><a class="tocitem" href="../../solvers/bvp_solve/">BVP Solvers</a></li><li><a class="tocitem" href="../../solvers/jump_solve/">Jump Problem and Jump Diffusion Solvers</a></li><li><a class="tocitem" href="../../solvers/sde_solve/">SDE Solvers</a></li><li><a class="tocitem" href="../../solvers/sdae_solve/">SDAE Solvers</a></li><li><a class="tocitem" href="../../solvers/rode_solve/">RODE Solvers</a></li><li><a class="tocitem" href="../../solvers/dde_solve/">DDE Solvers</a></li><li><a class="tocitem" href="../../solvers/sdde_solve/">SDDE Solvers</a></li><li><a class="tocitem" href="../../solvers/dae_solve/">DAE Solvers</a></li><li><a class="tocitem" href="../../solvers/benchmarks/">Solver Benchmarks</a></li></ul></li><li><span class="tocitem">Additional Features</span><ul><li><a class="tocitem" href="../../features/performance_overloads/">Jacobians, Gradients, etc.</a></li><li><a class="tocitem" href="../../features/diffeq_arrays/">DiffEq-Specific Array Types</a></li><li><a class="tocitem" href="../../features/diffeq_operator/">DiffEqOperators</a></li><li><a class="tocitem" href="../../features/noise_process/">Noise Processes</a></li><li><a class="tocitem" href="../../features/linear_nonlinear/">Specifying (Non)Linear Solvers and Preconditioners</a></li><li><a class="tocitem" href="../../features/callback_functions/">Event Handling and Callback Functions</a></li><li><a class="tocitem" href="../../features/callback_library/">Callback Library</a></li><li><a class="tocitem" href="../../features/ensemble/">Parallel Ensemble Simulations</a></li><li><a class="tocitem" href="../../features/io/">I/O: Saving and Loading Solution Data</a></li><li><a class="tocitem" href="../../features/low_dep/">Reduced Compile Time, Optimizing Runtime, and Low Dependency Usage</a></li><li><a class="tocitem" href="../../features/progress_bar/">Progress Bar Integration</a></li></ul></li><li><span class="tocitem">Detailed Solver APIs</span><ul><li><a class="tocitem" href="../../api/sundials/">Sundials.jl</a></li><li><a class="tocitem" href="../../api/daskr/">DASKR.jl</a></li></ul></li><li><span class="tocitem">Extra Details</span><ul><li><a class="tocitem" href="../../extras/timestepping/">Timestepping Method Descriptions</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Basics</a></li><li class="is-active"><a href>Plot Functions</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Plot Functions</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/SciML/DiffEqDocs.jl/blob/master/docs/src/basics/plot.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="plot"><a class="docs-heading-anchor" href="#plot">Plot Functions</a><a id="plot-1"></a><a class="docs-heading-anchor-permalink" href="#plot" title="Permalink"></a></h1><h2 id="Standard-Plots-Using-the-Plot-Recipe"><a class="docs-heading-anchor" href="#Standard-Plots-Using-the-Plot-Recipe">Standard Plots Using the Plot Recipe</a><a id="Standard-Plots-Using-the-Plot-Recipe-1"></a><a class="docs-heading-anchor-permalink" href="#Standard-Plots-Using-the-Plot-Recipe" title="Permalink"></a></h2><p>Plotting functionality is provided by recipes to Plots.jl. To plot solutions, simply call the <code>plot(type)</code> after importing Plots.jl and the plotter will generate appropriate plots.</p><pre><code class="language-julia hljs">#]add Plots # You need to install Plots.jl before your first time using it!
using Plots
plot(sol) # Plots the solution</code></pre><p>Many of the types defined in the DiffEq universe, such as <code>ODESolution</code>, <code>ConvergenceSimulation</code> <code>WorkPrecision</code>, etc. have plot recipes to handle the default plotting behavior. Plots can be customized using <a href="http://docs.juliaplots.org/dev/supported/">all of the keyword arguments provided by Plots.jl</a>. For example, we can change the plotting backend to the GR package and put a title on the plot by doing:</p><pre><code class="language-julia hljs">gr()
plot(sol,title=&quot;I Love DiffEqs!&quot;)</code></pre><p>Then to save the plot, use <code>savefig</code>, for example:</p><pre><code class="language-julia hljs">savefig(&quot;myplot.png&quot;)</code></pre><h2 id="Density"><a class="docs-heading-anchor" href="#Density">Density</a><a id="Density-1"></a><a class="docs-heading-anchor-permalink" href="#Density" title="Permalink"></a></h2><p>If the problem was solved with <code>dense=true</code>, then <code>denseplot</code> controls whether to use the dense function for generating the plot, and <code>plotdensity</code> is the number of evenly-spaced points (in time) to plot. For example:</p><pre><code class="language-julia hljs">plot(sol,denseplot=false)</code></pre><p>means &quot;only plot the points which the solver stepped to&quot;, while:</p><pre><code class="language-julia hljs">plot(sol,plotdensity=1000)</code></pre><p>means to plot 1000 points using the dense function (since <code>denseplot=true</code> by default).</p><h2 id="plot_vars"><a class="docs-heading-anchor" href="#plot_vars">Choosing Variables</a><a id="plot_vars-1"></a><a class="docs-heading-anchor-permalink" href="#plot_vars" title="Permalink"></a></h2><p>In the plot command, one can choose the variables to be plotted in each plot. The master form is:</p><pre><code class="language-julia hljs">idxs = [(f1,0,1), (f2,1,3), (f3,4,5)]</code></pre><p>which could be used to plot <code>f1(var₀, var₁)</code>, <code>f2(var₁, var₃)</code>, and <code>f3(var₄, var₅)</code>, all on the same graph. (<code>0</code> is considered to be <em>time</em>, or the independent variable). Functions <code>f1</code>, <code>f2</code> and <code>f3</code> should take in scalars and return a tuple. If no function is given, for example,</p><pre><code class="language-julia hljs">idxs = [(0,1), (1,3), (4,5)]</code></pre><p>this would mean &quot;plot <code>var₁(t)</code> vs <code>t</code> (<em>time</em>), <code>var₃(var₁)</code> vs <code>var₁</code>, and <code>var₅(var₄)</code> vs <code>var₄</code> all on the same graph, putting the independent variables (<code>t</code>, <code>var₁</code> and <code>var₄</code>) on the x-axis.&quot; While this can be used for everything, the following conveniences are provided:</p><ul><li>Everywhere in a tuple position where we only find an integer, this variable is plotted as a function of time.  For example, the list above is equivalent to:</li></ul><pre><code class="language-julia hljs">idxs = [1, (1,3), (4,5)]</code></pre><p>and</p><pre><code class="language-julia hljs">idxs = [1, 3, 4]</code></pre><p>is the most concise way to plot the variables 1, 3, and 4 as a function of time.</p><ul><li><p>It is possible to omit the list if only one plot is wanted: <code>(2,3)</code> and <code>4</code> are respectively equivalent to <code>[(2,3)]</code> and <code>[(0,4)]</code>.</p></li><li><p>A tuple containing one or several lists will be expanded by associating corresponding elements of the lists with each other:</p></li></ul><pre><code class="language-julia hljs">idxs = ([1,2,3], [4,5,6])</code></pre><p>is equivalent to</p><pre><code class="language-julia hljs">idxs = [(1,4), (2,5), (3,6)]</code></pre><p>and</p><pre><code class="language-julia hljs">idxs = (1, [2,3,4])</code></pre><p>is equivalent to</p><pre><code class="language-julia hljs">idxs = [(1,2), (1,3), (1,4)]</code></pre><ul><li><p>Instead of using integers, one can use the symbols from a <code>ParameterizedFunction</code>. For example, <code>idxs=(:x,:y)</code> will replace the symbols with the integer values for components <code>:x</code> and <code>:y</code>.</p></li><li><p>n-dimensional groupings are allowed. For example, <code>(1,2,3,4,5)</code> would be a 5-dimensional plot between the associated variables.</p></li></ul><h3 id="Complex-Numbers-and-High-Dimensional-Plots"><a class="docs-heading-anchor" href="#Complex-Numbers-and-High-Dimensional-Plots">Complex Numbers and High Dimensional Plots</a><a id="Complex-Numbers-and-High-Dimensional-Plots-1"></a><a class="docs-heading-anchor-permalink" href="#Complex-Numbers-and-High-Dimensional-Plots" title="Permalink"></a></h3><p>The recipe library DimensionalPlotRecipes.jl is provided for extra functionality on high dimensional numbers (complex numbers) and other high dimensional plots. See <a href="https://github.com/SciML/DimensionalPlotRecipes.jl">the README</a> for more details on the extra controls that exist.</p><h3 id="Timespan"><a class="docs-heading-anchor" href="#Timespan">Timespan</a><a id="Timespan-1"></a><a class="docs-heading-anchor-permalink" href="#Timespan" title="Permalink"></a></h3><p>A plotting timespan can be chosen by the <code>tspan</code> argument in <code>plot</code>. For example:</p><pre><code class="language-julia hljs">plot(sol,tspan=(0.0,40.0))</code></pre><p>only plots between <code>t=0.0</code> and <code>t=40.0</code>. If <code>denseplot=true</code> these bounds will be respected exactly. Otherwise the first point inside and last point inside the interval will be plotted, i.e. no points outside the interval will be plotted.</p><h3 id="Example"><a class="docs-heading-anchor" href="#Example">Example</a><a id="Example-1"></a><a class="docs-heading-anchor-permalink" href="#Example" title="Permalink"></a></h3><pre><code class="language-julia hljs">using DifferentialEquations, Plots
function lorenz(du,u,p,t)
 du[1] = p[1]*(u[2]-u[1])
 du[2] = u[1]*(p[2]-u[3]) - u[2]
 du[3] = u[1]*u[2] - p[3]*u[3]
end

u0 = [1., 5., 10.]
tspan = (0., 100.)
p = (10.0,28.0,8/3)
prob = ODEProblem(lorenz, u0, tspan,p)
sol = solve(prob)
xyzt = plot(sol, plotdensity=10000,lw=1.5)
xy = plot(sol, plotdensity=10000, idxs=(1,2))
xz = plot(sol, plotdensity=10000, idxs=(1,3))
yz = plot(sol, plotdensity=10000, idxs=(2,3))
xyz = plot(sol, plotdensity=10000, idxs=(1,2,3))
plot(plot(xyzt,xyz),plot(xy, xz, yz, layout=(1,3),w=1), layout=(2,1))</code></pre><p><img src="../../assets/vars_plotting_example.png" alt="lorenz_plot"/></p><p>An example using the functions:</p><pre><code class="language-julia hljs">f(x,y,z) = (sqrt(x^2+y^2+z^2),x)
plot(sol,idxs=(f,1,2,3))</code></pre><p><img src="../../assets/normalized.png" alt="norm_plot"/></p><p>or the norm over time:</p><pre><code class="language-julia hljs">f(t,x,y,z) = (t,sqrt(x^2+y^2+z^2))
plot(sol,idxs=(f,0,1,2,3))</code></pre><p><img src="https://user-images.githubusercontent.com/1814174/94351101-4667df80-0023-11eb-987d-aca652e32521.png" alt="normtime plot"/></p><h2 id="Animations"><a class="docs-heading-anchor" href="#Animations">Animations</a><a id="Animations-1"></a><a class="docs-heading-anchor-permalink" href="#Animations" title="Permalink"></a></h2><p>Using the iterator interface over the solutions, animations can also be generated via the <code>animate(sol)</code> command. One can choose the <code>filename</code> to save to via <code>animate(sol,filename)</code>, while the frames per second <code>fps</code> and the density of steps to show <code>every</code> can be specified via keyword arguments. The rest of the arguments will be directly passed to the plot recipe to be handled as normal. For example, we can animate our solution with a larger line-width which saves every 4th frame via:</p><pre><code class="language-julia hljs">#]add ImageMagick # You may need to install ImageMagick.jl before your first time using it!
#using ImageMagick # Some installations require using ImageMagick for good animations
animate(sol,lw=3,every=4)</code></pre><p>Please see <a href="https://juliaplots.github.io/">Plots.jl&#39;s documentation</a> for more information on the available attributes.</p><h2 id="Plotting-Without-the-Plot-Recipe"><a class="docs-heading-anchor" href="#Plotting-Without-the-Plot-Recipe">Plotting Without the Plot Recipe</a><a id="Plotting-Without-the-Plot-Recipe-1"></a><a class="docs-heading-anchor-permalink" href="#Plotting-Without-the-Plot-Recipe" title="Permalink"></a></h2><p>What if you don&#39;t want to use Plots.jl? Odd choice, but that&#39;s okay! If the differential equation was described by a vector of values, then the solution object acts as an <code>AbstractMatrix</code> <code>sol[i,j]</code> for the <code>i</code>th variable at timepoint <code>j</code>. You can use this to plot solutions. For example, in PyPlot, Gadfly, GR, etc., you can do the following to plot the timeseries:</p><pre><code class="language-julia hljs">plot(sol.t,sol&#39;)</code></pre><p>since these plot along the columns, and <code>sol&#39;</code> has the timeseries along the column. Phase plots can be done similarly, for example:</p><pre><code class="language-julia hljs">plot(sol[i,:],sol[j,:],sol[k,:])</code></pre><p>is a 3d phase plot between variables <code>i</code>, <code>j</code>, and <code>k</code>.</p><p>Notice that this does not use the interpolation. When not using the plot recipe, the interpolation must be done manually. For example:</p><pre><code class="language-julia hljs">n = 101 #number of timepoints
ts = range(0, stop=1, length=n)
plot(sol(ts,idxs=i),sol(ts,idxs=j),sol(ts,idxs=k))</code></pre><p>is the phase space using values <code>0.01</code> apart in time.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../solution/">« Solution Handling</a><a class="docs-footer-nextpage" href="../integrator/">Integrator Interface »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Saturday 10 December 2022 08:11">Saturday 10 December 2022</span>. Using Julia version 1.8.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
