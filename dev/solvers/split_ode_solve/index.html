<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Split ODE Solvers · DifferentialEquations.jl</title><script async src="https://www.googletagmanager.com/gtag/js?id=UA-90474609-3"></script><script>  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-90474609-3', {'page_path': location.pathname + location.search + location.hash});
</script><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://diffeq.sciml.ai/stable/solvers/split_ode_solve/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="DifferentialEquations.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">DifferentialEquations.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">DifferentialEquations.jl: Scientific Machine Learning (SciML) Enabled Simulation and Estimation</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../../tutorials/ode_example/">Ordinary Differential Equations</a></li><li><a class="tocitem" href="../../tutorials/faster_ode_example/">Code Optimization for Differential Equations</a></li><li><a class="tocitem" href="../../tutorials/advanced_ode_example/">Solving Large Stiff Equations</a></li><li><a class="tocitem" href="../../tutorials/sde_example/">Stochastic Differential Equations</a></li><li><a class="tocitem" href="../../tutorials/rode_example/">Random Ordinary Differential Equations</a></li><li><a class="tocitem" href="../../tutorials/dde_example/">Delay Differential Equations</a></li><li><a class="tocitem" href="../../tutorials/dae_example/">Differential Algebraic Equations</a></li><li><a class="tocitem" href="../../tutorials/discrete_stochastic_example/">Continuous-Time Jump Processes and Gillespie Methods</a></li><li><a class="tocitem" href="../../tutorials/jump_diffusion/">Jump Diffusion Equations</a></li><li><a class="tocitem" href="../../tutorials/bvp_example/">Boundary Value Problems</a></li><li><a class="tocitem" href="../../tutorials/additional/">Additional Tutorials</a></li></ul></li><li><span class="tocitem">Basics</span><ul><li><a class="tocitem" href="../../basics/overview/">Overview of DifferentialEquations.jl</a></li><li><a class="tocitem" href="../../basics/common_solver_opts/">Common Solver Options (Solve Keyword Arguments)</a></li><li><a class="tocitem" href="../../basics/solution/">Solution Handling</a></li><li><a class="tocitem" href="../../basics/plot/">Plot Functions</a></li><li><a class="tocitem" href="../../basics/integrator/">Integrator Interface</a></li><li><a class="tocitem" href="../../basics/problem/">Problem Interface</a></li><li><a class="tocitem" href="../../basics/faq/">Frequently Asked Questions</a></li><li><a class="tocitem" href="../../basics/compatibility_chart/">Solver Compatibility Chart</a></li></ul></li><li><span class="tocitem">Problem Types</span><ul><li><a class="tocitem" href="../../types/discrete_types/">Discrete Problems</a></li><li><a class="tocitem" href="../../types/ode_types/">ODE Problems</a></li><li><a class="tocitem" href="../../types/nonautonomous_linear_ode/">Non-autonomous Linear ODE / Lie Group Problems</a></li><li><a class="tocitem" href="../../types/dynamical_types/">Dynamical, Hamiltonian and 2nd Order ODE Problems</a></li><li><a class="tocitem" href="../../types/split_ode_types/">Split ODE Problems</a></li><li><a class="tocitem" href="../../types/steady_state_types/">Steady State Problems</a></li><li><a class="tocitem" href="../../types/bvp_types/">BVP Problems</a></li><li><a class="tocitem" href="../../types/sde_types/">SDE Problems</a></li><li><a class="tocitem" href="../../types/sdae_types/">SDAE Problems</a></li><li><a class="tocitem" href="../../types/rode_types/">RODE Problems</a></li><li><a class="tocitem" href="../../types/dde_types/">DDE Problems</a></li><li><a class="tocitem" href="../../types/sdde_types/">SDDE Problems</a></li><li><a class="tocitem" href="../../types/dae_types/">DAE Problems</a></li><li><a class="tocitem" href="../../types/jump_types/">Jump Problems</a></li></ul></li><li><span class="tocitem">Solver Algorithms</span><ul><li><a class="tocitem" href="../discrete_solve/">Discrete Solvers</a></li><li><a class="tocitem" href="../ode_solve/">ODE Solvers</a></li><li><a class="tocitem" href="../nonautonomous_linear_ode/">Non-autonomous Linear ODE / Lie Group ODE Solvers</a></li><li><a class="tocitem" href="../dynamical_solve/">Dynamical, Hamiltonian, and 2nd Order ODE Solvers</a></li><li class="is-active"><a class="tocitem" href>Split ODE Solvers</a><ul class="internal"><li><a class="tocitem" href="#Implicit-Explicit-(IMEX)-ODE"><span>Implicit-Explicit (IMEX) ODE</span></a></li><li><a class="tocitem" href="#Semilinear-ODE"><span>Semilinear ODE</span></a></li></ul></li><li><a class="tocitem" href="../steady_state_solve/">Steady State Solvers</a></li><li><a class="tocitem" href="../bvp_solve/">BVP Solvers</a></li><li><a class="tocitem" href="../jump_solve/">Jump Problem and Jump Diffusion Solvers</a></li><li><a class="tocitem" href="../sde_solve/">SDE Solvers</a></li><li><a class="tocitem" href="../sdae_solve/">SDAE Solvers</a></li><li><a class="tocitem" href="../rode_solve/">RODE Solvers</a></li><li><a class="tocitem" href="../dde_solve/">DDE Solvers</a></li><li><a class="tocitem" href="../sdde_solve/">SDDE Solvers</a></li><li><a class="tocitem" href="../dae_solve/">DAE Solvers</a></li><li><a class="tocitem" href="../benchmarks/">Solver Benchmarks</a></li></ul></li><li><span class="tocitem">Additional Features</span><ul><li><a class="tocitem" href="../../features/performance_overloads/">Jacobians, Gradients, etc.</a></li><li><a class="tocitem" href="../../features/diffeq_arrays/">DiffEq-Specific Array Types</a></li><li><a class="tocitem" href="../../features/diffeq_operator/">DiffEqOperators</a></li><li><a class="tocitem" href="../../features/noise_process/">Noise Processes</a></li><li><a class="tocitem" href="../../features/linear_nonlinear/">Specifying (Non)Linear Solvers and Preconditioners</a></li><li><a class="tocitem" href="../../features/callback_functions/">Event Handling and Callback Functions</a></li><li><a class="tocitem" href="../../features/callback_library/">Callback Library</a></li><li><a class="tocitem" href="../../features/ensemble/">Parallel Ensemble Simulations</a></li><li><a class="tocitem" href="../../features/io/">I/O: Saving and Loading Solution Data</a></li><li><a class="tocitem" href="../../features/low_dep/">Reduced Compile Time, Optimizing Runtime, and Low Dependency Usage</a></li><li><a class="tocitem" href="../../features/progress_bar/">Progress Bar Integration</a></li></ul></li><li><span class="tocitem">Extra Details</span><ul><li><a class="tocitem" href="../../extras/timestepping/">Timestepping Method Descriptions</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Solver Algorithms</a></li><li class="is-active"><a href>Split ODE Solvers</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Split ODE Solvers</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/SciML/DiffEqDocs.jl/blob/master/docs/src/solvers/split_ode_solve.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="split_ode_solve"><a class="docs-heading-anchor" href="#split_ode_solve">Split ODE Solvers</a><a id="split_ode_solve-1"></a><a class="docs-heading-anchor-permalink" href="#split_ode_solve" title="Permalink"></a></h1><p>The solvers which are available for a <code>SplitODEProblem</code> depend on the input linearity and number of components. Each solver has functional form (or many) that it allows.</p><h2 id="Implicit-Explicit-(IMEX)-ODE"><a class="docs-heading-anchor" href="#Implicit-Explicit-(IMEX)-ODE">Implicit-Explicit (IMEX) ODE</a><a id="Implicit-Explicit-(IMEX)-ODE-1"></a><a class="docs-heading-anchor-permalink" href="#Implicit-Explicit-(IMEX)-ODE" title="Permalink"></a></h2><p>The Implicit-Explicit (IMEX) ODE is a <code>SplitODEProblem</code> with two functions:</p><p class="math-container">\[\frac{du}{dt} =  f_1(t,u) + f_2(t,u)\]</p><p>where the first function is the stiff part and the second function is the non-stiff part (implicit integration on <code>f1</code>, explicit integration on <code>f2</code>).</p><h3 id="Recommended-Methods"><a class="docs-heading-anchor" href="#Recommended-Methods">Recommended Methods</a><a id="Recommended-Methods-1"></a><a class="docs-heading-anchor-permalink" href="#Recommended-Methods" title="Permalink"></a></h3><p>The recommended method in most cases is <code>KenCarp4</code>. In cases of extreme stiffness or for high tolerances, <code>KenCarp3</code> can be a good choice. The <code>ARKODE</code> methods are generally inefficient and diverge unless the options are tweaked to match the problem, though for large enough PDEs the <code>ARKODE</code> method with <code>linear_solver=:GMRES</code> is a good choice.</p><h3 id="OrdinaryDiffEq.jl"><a class="docs-heading-anchor" href="#OrdinaryDiffEq.jl">OrdinaryDiffEq.jl</a><a id="OrdinaryDiffEq.jl-1"></a><a class="docs-heading-anchor-permalink" href="#OrdinaryDiffEq.jl" title="Permalink"></a></h3><ul><li><code>SplitEuler</code>: 1st order fully explicit method. Used for testing accuracy of splits.</li><li><code>IMEXEuler</code> : 1st order explicit Euler mixed with implicit Euler. Fixed time step only.</li><li><code>CNAB2</code>: Crank-Nicolson Adams Bashforth Order 2. Fixed time step only.</li><li><code>CNLF</code>: Crank-Nicolson Leapfrog of Order 2. Fixed time step only.</li><li><code>SBDF2</code> : 2nd order IMEX BDF method. Fixed time step only.</li><li><code>SBDF3</code> : 3rd order IMEX BDF method. Fixed time step only. In development.</li><li><code>SBDF4</code> : 4th order IMEX BDF method. Fixed time step only. In development.</li><li><code>KenCarp3</code>: An A-L stable stiffly-accurate 3rd order ESDIRK method.</li><li><code>KenCarp4</code>: An A-L stable stiffly-accurate 4rd order ESDIRK method.</li><li><code>KenCarp47</code> - An A-L stable stiffly-accurate 4th order seven-stage ESDIRK method with splitting</li><li><code>KenCarp5</code>: An A-L stable stiffly-accurate 5rd order ESDIRK method.</li><li><code>KenCarp58</code> - An A-L stable stiffly-accurate 5th order eight-stage ESDIRK method with splitting</li></ul><h3 id="Sundials.jl"><a class="docs-heading-anchor" href="#Sundials.jl">Sundials.jl</a><a id="Sundials.jl-1"></a><a class="docs-heading-anchor-permalink" href="#Sundials.jl" title="Permalink"></a></h3><ul><li><code>ARKODE</code>: An additive Runge-Kutta method. Order between 3rd and 5th. For a list of available options, please see <a href="https://diffeq.sciml.ai/dev/solvers/ode_solve/#ode_solve_sundials">its ODE solver page</a></li></ul><h2 id="Semilinear-ODE"><a class="docs-heading-anchor" href="#Semilinear-ODE">Semilinear ODE</a><a id="Semilinear-ODE-1"></a><a class="docs-heading-anchor-permalink" href="#Semilinear-ODE" title="Permalink"></a></h2><p>The Semilinear ODE is a <code>SplitODEProblem</code> with one linear operator and one nonlinear function:</p><p class="math-container">\[\frac{du}{dt} =  Au + f(t,u)\]</p><p>See the documentation page for <a href="../../features/diffeq_operator/#DiffEqOperators">DiffEqOperators</a> for details about how to define linear operators from a matrix or finite difference discretization of derivative operators.</p><p>The appropriate algorithms for this form are:</p><h3 id="OrdinaryDiffEq.jl-2"><a class="docs-heading-anchor" href="#OrdinaryDiffEq.jl-2">OrdinaryDiffEq.jl</a><a class="docs-heading-anchor-permalink" href="#OrdinaryDiffEq.jl-2" title="Permalink"></a></h3><ul><li><code>LawsonEuler</code> - First order exponential Euler scheme. Fixed timestepping only.</li><li><code>NorsettEuler</code> - First order exponential-RK scheme. Fixed timestepping only. Alias: <code>ETD1</code>.</li><li><code>ETD2</code> - Second order Exponential Time Differencing method (in development). Fixed timestepping only. Doesn&#39;t support Krylov approximation.</li><li><code>ETDRK2</code> - 2nd order exponential-RK scheme. Fixed timestepping only.</li><li><code>ETDRK3</code> - 3rd order exponential-RK scheme. Fixed timestepping only.</li><li><code>ETDRK4</code> - 4th order exponential-RK scheme. Fixed timestepping only.</li><li><code>HochOst4</code> - 4th order exponential-RK scheme with stiff order 4. Fixed timestepping only.</li></ul><p>Note that the generic algorithms <code>GenericIIF1</code> and <code>GenericIIF2</code> allow for a choice of <code>nlsolve</code>.</p><p>By default, the exponential methods cache matrix functions such as <code>exp(dt*A)</code> to accelerate the time stepping for small systems. For large systems, using Krylov-based versions of the methods can allow for lazy calculation of <code>exp(dt*A)*v</code> and similar entities, and thus improve performance.</p><p>To tell a solver to use Krylov methods, pass <code>krylov=true</code> to its constructor. You can also manually set the size of the Krylov subspace by setting the <code>m</code> parameter, which defaults to 30. For example</p><pre><code class="language-julia hljs">LawsonEuler(krylov=true, m=50)</code></pre><p>constructs a Lawson-Euler method which uses a size-50 Krylov subspace. Note that <code>m</code> only sets an upper bound to the Krylov subspace size. If a convergence criterion is met (determined by the <code>reltol</code> of the integrator), &quot;happy breakdown&quot; will occur and the Krylov subspace will only be constructed partially.</p><p>For more advanced control over the Krylov algorithms, you can change the length of the incomplete orthogonalization procedure (IOP) <sup class="footnote-reference"><a id="citeref-1" href="#footnote-1">[1]</a></sup> by setting the <code>iop</code> parameter in the constructor. By default, IOP is turned off and full Arnoldi iteration is used. Note that if the linear operator is hermitian, then the Lanczos algorithm will always be used and IOP setting is ignored.</p><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-1"><a class="tag is-link" href="#citeref-1">1</a>Koskela, A. (2015). Approximating the matrix exponential of an advection-diffusion operator using the incomplete orthogonalization method. In Numerical Mathematics and Advanced Applications-ENUMATH 2013 (pp. 345-353). Springer, Cham.</li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../dynamical_solve/">« Dynamical, Hamiltonian, and 2nd Order ODE Solvers</a><a class="docs-footer-nextpage" href="../steady_state_solve/">Steady State Solvers »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Saturday 19 November 2022 17:32">Saturday 19 November 2022</span>. Using Julia version 1.8.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
