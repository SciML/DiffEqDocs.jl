<!DOCTYPE html><HTML lang="en"><head><meta charset="UTF-8"/><meta content="width=device-width, initial-scale=1.0" name="viewport"/><title>Split ODE Solvers · DifferentialEquations.jl</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-90474609-3', 'auto');
ga('send', 'pageview');
</script><link href="https://docs.juliadiffeq.org/stable/solvers/split_ode_solve/index.html" rel="canonical"/><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script data-main="../../assets/documenter.js" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link href="../../assets/documenter.css" rel="stylesheet" type="text/css"/><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/><script data-is-old-version="">document.addEventListener("DOMContentLoaded", function(){
    const div = document.createElement('div');
    div.setAttribute('style', 'position: fixed; bottom: 1em; right: 1em; z-index: 999; background-color: #ffaf9c; color: rgba(0, 0, 0, 0.7); border: 1px solid #d54625; border-radius: 4px; padding: 2em; text-align: center');
    const closer = document.createElement('div');
    closer.setAttribute('style', 'position: absolute; top: 0; right: 5px; padding: 5px; cursor: pointer; width: 12px; height: 12px;')
    // Icon by font-awesome (license: https://fontawesome.com/license, link: https://fontawesome.com/icons/times?style=solid)
    closer.innerHTML = '<svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="times" class="svg-inline--fa fa-times fa-w-11" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 352 512"><path fill="currentColor" d="M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z"></path></svg>';
    closer.addEventListener('click', () => {
        document.body.removeChild(div)
    })
    const href = documenterBaseURL + '/../stable'
    div.innerHTML = 'This is an old version of the documentation. <br> Click <a href="' + href + '">here</a> to go to the newest version.';
    div.appendChild(closer)
    document.body.appendChild(div);
});
</script><script data-outdated-warner="">function maybeAddWarning () {
    const head = document.getElementsByTagName('head')[0];

    // Add a noindex meta tag (unless one exists) so that search engines don't index this version of the docs.
    if (document.body.querySelector('meta[name="robots"]') === null) {
        const meta = document.createElement('meta');
        meta.name = 'robots';
        meta.content = 'noindex';

        head.appendChild(meta);
    };

    // Add a stylesheet to avoid inline styling
    const style = document.createElement('style');
    style.type = 'text/css';
    style.appendChild(document.createTextNode('.outdated-warning-overlay {  position: fixed;  top: 0;  left: 0;  right: 0;  box-shadow: 0 0 10px rgba(0, 0, 0, 0.3);  z-index: 999;  background-color: #ffaba7;  color: rgba(0, 0, 0, 0.7);  border-bottom: 3px solid #da0b00;  padding: 10px 35px;  text-align: center;  font-size: 15px; }  .outdated-warning-overlay .outdated-warning-closer {    position: absolute;    top: calc(50% - 10px);    right: 18px;    cursor: pointer;    width: 12px; }  .outdated-warning-overlay a {    color: #2e63b8; }    .outdated-warning-overlay a:hover {      color: #363636; }'));
    head.appendChild(style);

    const div = document.createElement('div');
    div.classList.add('outdated-warning-overlay');
    const closer = document.createElement('div');
    closer.classList.add('outdated-warning-closer');

    // Icon by font-awesome (license: https://fontawesome.com/license, link: https://fontawesome.com/icons/times?style=solid)
    closer.innerHTML = '<svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="times" class="svg-inline--fa fa-times fa-w-11" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 352 512"><path fill="currentColor" d="M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z"></path></svg>';
    closer.addEventListener('click', function () {
        document.body.removeChild(div);
    });
    let href = '/stable';
    if (window.documenterBaseURL) {
        href = window.documenterBaseURL + '/../stable';
    }
    div.innerHTML = 'This is an old version of the documentation. <br> <a href="' + href + '">Go to the newest version</a>.';
    div.appendChild(closer);
    document.body.appendChild(div);
};

if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', maybeAddWarning);
} else {
    maybeAddWarning();
};
</script></head><body><nav class="toc"><a href="../../"><img alt="DifferentialEquations.jl logo" class="logo" src="../../assets/logo.png"/></a><h1>DifferentialEquations.jl</h1><select id="version-selector" onchange="window.location.href=this.value" style="visibility: hidden"></select><form action="../../search/" class="search" id="search-form"><input id="search-query" name="q" placeholder="Search docs" type="text"/></form><ul><li><a class="toctext" href="../../">Home</a></li><li><span class="toctext">Tutorials</span><ul><li><a class="toctext" href="../../tutorials/ode_example/">Ordinary Differential Equations</a></li><li><a class="toctext" href="../../tutorials/advanced_ode_example/">Solving Stiff Equations</a></li><li><a class="toctext" href="../../tutorials/sde_example/">Stochastic Differential Equations</a></li><li><a class="toctext" href="../../tutorials/rode_example/">Random Ordinary Differential Equations</a></li><li><a class="toctext" href="../../tutorials/dde_example/">Delay Differential Equations</a></li><li><a class="toctext" href="../../tutorials/dae_example/">Differential Algebraic Equations</a></li><li><a class="toctext" href="../../tutorials/discrete_stochastic_example/">Discrete Stochastic (Gillespie) Equations</a></li><li><a class="toctext" href="../../tutorials/jump_diffusion/">Jump Diffusion Equations</a></li><li><a class="toctext" href="../../tutorials/bvp_example/">Boundary Value Problems</a></li><li><a class="toctext" href="../../tutorials/additional/">Additional Tutorials</a></li></ul></li><li><span class="toctext">Basics</span><ul><li><a class="toctext" href="../../basics/overview/">Overview of DifferentialEquations.jl</a></li><li><a class="toctext" href="../../basics/common_solver_opts/">Common Solver Options</a></li><li><a class="toctext" href="../../basics/solution/">Solution Handling</a></li><li><a class="toctext" href="../../basics/plot/">Plot Functions</a></li><li><a class="toctext" href="../../basics/integrator/">Integrator Interface</a></li><li><a class="toctext" href="../../basics/problem/">Problem Interface</a></li><li><a class="toctext" href="../../basics/faq/">Frequently Asked Questions</a></li><li><a class="toctext" href="../../basics/compatibility_chart/">Solver Compatibility Chart</a></li></ul></li><li><span class="toctext">Problem Types</span><ul><li><a class="toctext" href="../../types/discrete_types/">Discrete Problems</a></li><li><a class="toctext" href="../../types/ode_types/">ODE Problems</a></li><li><a class="toctext" href="../../types/dynamical_types/">Dynamical, Hamiltonian and 2nd Order ODE Problems</a></li><li><a class="toctext" href="../../types/split_ode_types/">Split ODE Problems</a></li><li><a class="toctext" href="../../types/steady_state_types/">Steady State Problems</a></li><li><a class="toctext" href="../../types/bvp_types/">BVP Problems</a></li><li><a class="toctext" href="../../types/sde_types/">SDE Problems</a></li><li><a class="toctext" href="../../types/rode_types/">RODE Problems</a></li><li><a class="toctext" href="../../types/dde_types/">DDE Problems</a></li><li><a class="toctext" href="../../types/dae_types/">DAE Problems</a></li><li><a class="toctext" href="../../types/jump_types/">Jump Problems</a></li></ul></li><li><span class="toctext">Solver Algorithms</span><ul><li><a class="toctext" href="../discrete_solve/">Discrete Solvers</a></li><li><a class="toctext" href="../ode_solve/">ODE Solvers</a></li><li><a class="toctext" href="../dynamical_solve/">Dynamical, Hamiltonian, and 2nd Order ODE Solvers</a></li><li class="current"><a class="toctext" href="">Split ODE Solvers</a><ul class="internal"><li><a class="toctext" href="#Implicit-Explicit-(IMEX)-ODE-1">Implicit-Explicit (IMEX) ODE</a></li><li><a class="toctext" href="#Semilinear-ODE-1">Semilinear ODE</a></li></ul></li><li><a class="toctext" href="../steady_state_solve/">Steady State Solvers</a></li><li><a class="toctext" href="../bvp_solve/">BVP Solvers</a></li><li><a class="toctext" href="../jump_solve/">Jump Problem Solvers</a></li><li><a class="toctext" href="../sde_solve/">SDE Solvers</a></li><li><a class="toctext" href="../rode_solve/">RODE Solvers</a></li><li><a class="toctext" href="../dde_solve/">DDE Solvers</a></li><li><a class="toctext" href="../dae_solve/">DAE Solvers</a></li><li><a class="toctext" href="../benchmarks/">Solver Benchmarks</a></li></ul></li><li><span class="toctext">Additional Features</span><ul><li><a class="toctext" href="../../features/performance_overloads/">DiffEqFunctions (Jacobians, Gradients, etc.) and Jacobian Types</a></li><li><a class="toctext" href="../../features/diffeq_arrays/">DiffEq-Specific Array Types</a></li><li><a class="toctext" href="../../features/diffeq_operator/">DiffEqOperators</a></li><li><a class="toctext" href="../../features/noise_process/">Noise Processes</a></li><li><a class="toctext" href="../../features/linear_nonlinear/">Specifying (Non)Linear Solvers</a></li><li><a class="toctext" href="../../features/callback_functions/">Event Handling and Callback Functions</a></li><li><a class="toctext" href="../../features/callback_library/">Callback Library</a></li><li><a class="toctext" href="../../features/ensemble/">Parallel Ensemble Simulations</a></li><li><a class="toctext" href="../../features/io/">I/O: Saving and Loading Solution Data</a></li><li><a class="toctext" href="../../features/low_dep/">Low Dependency Usage</a></li><li><a class="toctext" href="../../features/progress_bar/">Juno Progress Bar Integration</a></li></ul></li><li><span class="toctext">Analysis Tools</span><ul><li><a class="toctext" href="../../analysis/parameterized_functions/">ParameterizedFunctions</a></li><li><a class="toctext" href="../../analysis/parameter_estimation/">Parameter Estimation and Bayesian Analysis</a></li><li><a class="toctext" href="../../analysis/bifurcation/">Bifurcation Analysis</a></li><li><a class="toctext" href="../../analysis/sensitivity/">Local Sensitivity Analysis (Automatic Differentiation)</a></li><li><a class="toctext" href="../../analysis/global_sensitivity/">Global Sensitivity Analysis</a></li><li><a class="toctext" href="../../analysis/uncertainty_quantification/">Uncertainty Quantification</a></li><li><a class="toctext" href="../../analysis/neural_networks/">Neural Networks</a></li><li><a class="toctext" href="../../analysis/dev_and_test/">Algorithm Development and Testing</a></li></ul></li><li><span class="toctext">Domain Modeling Tools</span><ul><li><a class="toctext" href="../../models/multiscale/">Multi-Scale Models</a></li><li><a class="toctext" href="../../models/physical/">Physical Models</a></li><li><a class="toctext" href="../../models/financial/">Financial Models</a></li><li><a class="toctext" href="../../models/biological/">Chemical Reaction Models</a></li><li><a class="toctext" href="../../models/external_modeling/">External Modeling Packages</a></li></ul></li><li><span class="toctext">APIs</span><ul><li><span class="toctext">DiffEqBase API</span><ul><li><a class="toctext" href="../../apis/diffeqbase/overview/">Overview</a></li><li><a class="toctext" href="../../apis/diffeqbase/functions/">DE functions</a></li><li><a class="toctext" href="../../apis/diffeqbase/problems/">Problems</a></li><li><a class="toctext" href="../../apis/diffeqbase/solutions/">Solutions</a></li><li><a class="toctext" href="../../apis/diffeqbase/solvers/">Solvers</a></li><li><a class="toctext" href="../../apis/diffeqbase/de_types/">DE types</a></li><li><a class="toctext" href="../../apis/diffeqbase/operators/">Operators</a></li><li><a class="toctext" href="../../apis/diffeqbase/callbacks/">Callbacks</a></li><li><a class="toctext" href="../../apis/diffeqbase/interpolation/">Interpolation</a></li><li><a class="toctext" href="../../apis/diffeqbase/ensembles/">Ensembles</a></li><li><a class="toctext" href="../../apis/diffeqbase/data_arrays/">Data arrays</a></li><li><a class="toctext" href="../../apis/diffeqbase/noise/">Noise processes</a></li><li><a class="toctext" href="../../apis/diffeqbase/utility/">Utility</a></li></ul></li><li><a class="toctext" href="../../apis/diffeqbio/">DiffEqBiological.jl API</a></li></ul></li><li><span class="toctext">Extra Details</span><ul><li><a class="toctext" href="../../extras/timestepping/">Timestepping Method Descriptions</a></li></ul></li></ul></nav><article id="docs"><header><nav><ul><li>Solver Algorithms</li><li><a href="">Split ODE Solvers</a></li></ul><a class="edit-page" href="https://github.com/JuliaDiffEq/DiffEqDocs.jl/blob/master/docs/src/solvers/split_ode_solve.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Split ODE Solvers</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" href="#Split-ODE-Solvers-1" id="Split-ODE-Solvers-1">Split ODE Solvers</a></h1><p>The solvers which are available for a <code>SplitODEProblem</code> depend on the input linearity and number of components. Each solver has functional form (or many) that it allows.</p><h2><a class="nav-anchor" href="#Implicit-Explicit-(IMEX)-ODE-1" id="Implicit-Explicit-(IMEX)-ODE-1">Implicit-Explicit (IMEX) ODE</a></h2><p>The Implicit-Explicit (IMEX) ODE is a <code>SplitODEProblem</code> with two functions:</p><div>\[\frac{du}{dt} =  f_1(t,u) + f_2(t,u)\]</div><p>where the first function is the stiff part and the second function is the non-stiff part (implicit integration on <code>f1</code>, explicit integration on <code>f2</code>).</p><h3><a class="nav-anchor" href="#Recommended-Methods-1" id="Recommended-Methods-1">Recommended Methods</a></h3><p>The recommended method in most cases is <code>KenCarp4</code>. In cases of extreme stiffness or for high tolerances, <code>KenCarp3</code> can be a good choice. The <code>ARKODE</code> methods are generally inefficient and diverge unless the options are tweaked to match the problem, though for large enough PDEs the <code>ARKODE</code> method with <code>linear_solver=:GMRES</code> is a good choice.</p><h3><a class="nav-anchor" href="#OrdinaryDiffEq.jl-1" id="OrdinaryDiffEq.jl-1">OrdinaryDiffEq.jl</a></h3><ul><li><code>SplitEuler</code>: 1st order fully explicit method. Used for testing accuracy of splits.</li><li><code>IMEXEuler</code> : 1st order explicit Euler mixed with implicit Euler. Fixed time step only.</li><li><code>CNAB2</code>: Crank-Nicholson Adams Bashforth Order 2. Fixed time step only.</li><li><code>CNLF</code>: Crank-Nicholson Leapfrog of Order 2. Fixed time step only.</li><li><code>SBDF2</code> : 2nd order IMEX BDF method. Fixed time step only.</li><li><code>SBDF3</code> : 3rd order IMEX BDF method. Fixed time step only. In development.</li><li><code>SBDF4</code> : 4th order IMEX BDF method. Fixed time step only. In development.</li><li><code>KenCarp3</code>: An A-L stable stiffly-accurate 3rd order ESDIRK method.</li><li><code>KenCarp4</code>: An A-L stable stiffly-accurate 4rd order ESDIRK method.</li><li><code>KenCarp5</code>: An A-L stable stiffly-accurate 5rd order ESDIRK method.</li></ul><h3><a class="nav-anchor" href="#Sundials.jl-1" id="Sundials.jl-1">Sundials.jl</a></h3><ul><li><code>ARKODE</code>: An additive Runge-Kutta method. Order between 3rd and 5th. For a list of available options, please see <a href="http://docs.juliadiffeq.org/dev/solvers/ode_solve#Sundials.jl-1">its ODE solver page</a></li></ul><h2><a class="nav-anchor" href="#Semilinear-ODE-1" id="Semilinear-ODE-1">Semilinear ODE</a></h2><p>The Semilinear ODE is a <code>SplitODEProblem</code> with one linear operator and one nonlinear function:</p><div>\[\frac{du}{dt} =  Au + f(t,u)\]</div><p>See the documentation page for <a href="../../features/diffeq_operator">DiffEqOperator</a> for details about how to define linear operators from a matrix or finite difference discretization of derivative operators.</p><p>The appropriate algorithms for this form are:</p><h3><a class="nav-anchor" href="#OrdinaryDiffEq.jl-2" id="OrdinaryDiffEq.jl-2">OrdinaryDiffEq.jl</a></h3><ul><li><code>GenericIIF1</code> - First order Implicit Integrating Factor method. Fixed timestepping only. Doesn't support Krylov approximation.</li><li><code>GenericIIF2</code> - Second order Implicit Integrating Factor method. Fixed timestepping only. Doesn't support Krylov approximation.</li><li><code>LawsonEuler</code> - First order exponential Euler scheme. Fixed timestepping only.</li><li><code>NorsettEuler</code> - First order exponential-RK scheme. Fixed timestepping only. Alias: <code>ETD1</code>.</li><li><code>ETD2</code> - Second order Exponential Time Differencing method (in development). Fixed timestepping only. Doesn't support Krylov approximation.</li><li><code>ETDRK2</code> - 2nd order exponential-RK scheme. Fixed timestepping only.</li><li><code>ETDRK3</code> - 3rd order exponential-RK scheme. Fixed timestepping only.</li><li><code>ETDRK4</code> - 4th order exponential-RK scheme. Fixed timestepping only.</li><li><code>HochOst4</code> - 4th order exponential-RK scheme with stiff order 4. Fixed timestepping only.</li><li><code>Exprb32</code> - 3rd order adaptive Exponential Rosenbrock scheme (in development).</li><li><code>Exprb43</code> - 4th order adaptive Exponential Rosenbrock scheme (in development).</li></ul><p>Note that the generic algorithms <code>GenericIIF1</code> and <code>GenericIIF2</code> allow for a choice of <code>nlsolve</code>.</p><p>By default, the exponential methods cache matrix functions such as <code>exp(dt*A)</code> to accelerate the time stepping for small systems. For large systems, using Krylov-based versions of the methods can allow for lazy calculation of <code>exp(dt*A)*v</code> and similar entities, and thus improve performance.</p><p>To tell a solver to use Krylov methods, pass <code>krylov=true</code> to its constructor. You can also manually set the size of the Krylov subspace by setting the <code>m</code> parameter, which defaults to 30. For example</p><pre><code class="language-julia">LawsonEuler(krylov=true, m=50)</code></pre><p>constructs a Lawson-Euler method which uses a size-50 Krylov subspace. Note that <code>m</code> only sets an upper bound to the Krylov subspace size. If a convergence criterion is met (determined by the <code>reltol</code> of the integrator), "happy breakdown" will occur and the Krylov subspace will only be constructed partially.</p><p>For more advanced control over the Krylov algorithms, you can change the length of the incomplete orthogonalization procedure (IOP) <a href="#footnote-1">[1]</a> by setting the <code>iop</code> parameter in the constructor. By default, IOP is turned off and full Arnoldi iteration is used. Note that if the linear operator is hermitian, then the Lanczos algorithm will always be used and IOP setting is ignored.</p><div class="footnote" id="footnote-1"><a href="#footnote-1"><strong>[1]</strong></a><p>Koskela, A. (2015). Approximating the matrix exponential of an advection-diffusion operator using the incomplete orthogonalization method. In Numerical Mathematics and Advanced Applications-ENUMATH 2013 (pp. 345-353). Springer, Cham.</p></div><footer><hr/><a class="previous" href="../dynamical_solve/"><span class="direction">Previous</span><span class="title">Dynamical, Hamiltonian, and 2nd Order ODE Solvers</span></a><a class="next" href="../steady_state_solve/"><span class="direction">Next</span><span class="title">Steady State Solvers</span></a></footer></article></body></HTML>